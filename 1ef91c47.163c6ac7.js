(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{142:function(e,n,t){"use strict";t.d(n,"a",(function(){return l})),t.d(n,"b",(function(){return m}));var a=t(0),r=t.n(a);function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function b(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)t=c[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)t=c[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=r.a.createContext({}),d=function(e){var n=r.a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},l=function(e){var n=d(e.components);return r.a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},p=r.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,c=e.originalType,o=e.parentName,s=b(e,["components","mdxType","originalType","parentName"]),l=d(t),p=a,m=l["".concat(o,".").concat(p)]||l[p]||u[p]||c;return t?r.a.createElement(m,i(i({ref:n},s),{},{components:t})):r.a.createElement(m,i({ref:n},s))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var c=t.length,o=new Array(c);o[0]=p;var i={};for(var b in n)hasOwnProperty.call(n,b)&&(i[b]=n[b]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var s=2;s<c;s++)o[s]=t[s];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},83:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return i})),t.d(n,"toc",(function(){return b})),t.d(n,"default",(function(){return d}));var a=t(3),r=t(7),c=(t(0),t(142)),o={id:"jsonata",title:"JSONata, query and transform"},i={unversionedId:"jsonata",id:"jsonata",isDocsHomePage:!1,title:"JSONata, query and transform",description:"YAWE integrates in its READ endpoints JSONata, a library that allows you to query, filter, sort and transform your data! (and more!)",source:"@site/docs/jsonata.md",slug:"/jsonata",permalink:"/docs/jsonata",version:"current",sidebar:"docs",previous:{title:"Real-time data",permalink:"/docs/websockets"},next:{title:"Change log",permalink:"/docs/change-log"}},b=[{value:"Usage",id:"usage",children:[]},{value:"Common Expressions",id:"common-expressions",children:[]},{value:"Simple queries",id:"simple-queries",children:[]},{value:"Filtering",id:"filtering",children:[]},{value:"Pagination",id:"pagination",children:[]},{value:"Sorting",id:"sorting",children:[]},{value:"Working with dates",id:"working-with-dates",children:[]}],s={toc:b};function d(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},s,t,{components:n,mdxType:"MDXLayout"}),Object(c.b)("p",null,"YAWE integrates in its ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/crud/crud-read"}),"READ")," endpoints ",Object(c.b)("strong",{parentName:"p"},"JSONata"),", a library that allows you to query, filter, sort and transform your data! (and more!)"),Object(c.b)("p",null,"To check the oficial documentation please visit their website, ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.jsonata.org/overview.html"}),"https://docs.jsonata.org/overview.html"),"."),Object(c.b)("p",null,"On this page you will find a quick starting guide to use JSONata expressions for the most common usages."),Object(c.b)("p",null,Object(c.b)("inlineCode",{parentName:"p"},"JSONata version: 1.8.4")),Object(c.b)("h2",{id:"usage"},"Usage"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),"let jsonataExp = `$[createdAt=\"2021-01-03T21:58:31.000Z\"]`;\njsonataExp = encodeURI(jsonataExp);\n\nfetch('https://app.yawe.dev/api/1/ce/examples/unsecure-endpoint' +\n'?key=d59eb2859c284168ac48aef65046d5dd' +\n'&jsonata=' + jsonataExp);\n")),Object(c.b)("p",null,"The JSONata expression is sent in the URL using the parameter ",Object(c.b)("strong",{parentName:"p"},"jsonata"),", we recommend to encode the expression to ensure that special characters are sent properly in the request."),Object(c.b)("p",null,"Please remember:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Only READ endpoints accept JSONata expressions."),Object(c.b)("li",{parentName:"ul"},"The expression is evaluated using the result of the read operation. You need to take into account when using other parameters like ",Object(c.b)("em",{parentName:"li"},"dataOnly")," or ",Object(c.b)("em",{parentName:"li"},"uniqueId"),".")),Object(c.b)("h2",{id:"common-expressions"},"Common Expressions"),Object(c.b)("p",null,"JSONata helps us solve the most common cases when it comes to extracting data from JSON. Here you can find some basic expressions."),Object(c.b)("p",null,"We will use the following JSON to test our expressions."),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript"}),'[\n  {\n    "uniqueId": "9157c740159e4ff18b4a42d4a0c39622",\n    "data": {\n      "name": "Eduardo",\n      "phone": 999888727,\n      "age": 30\n    },\n    "createdAt": "2021-02-03T21:54:37.000Z",\n    "updatedAt": "2021-02-03T21:54:37.000Z"\n  },\n  {\n    "uniqueId": "66a1212c55ce47f9bc055e6c331b7af3",\n    "data": {\n      "name": "Miguel",\n      "age": 17,\n      "phone": 999888777\n    },\n    "createdAt": "2021-02-03T21:56:54.000Z",\n    "updatedAt": "2021-02-03T21:56:54.000Z"\n  },\n  {\n    "uniqueId": "86011b52ebc640aeba53a6e09a9d9773",\n    "data": {\n      "name": "Marco",\n      "age": 18\n    },\n    "createdAt": "2021-02-04T21:57:59.000Z",\n    "updatedAt": "2021-02-04T21:57:59.000Z"\n  },\n  {\n    "uniqueId": "0f6586aa7ccf4901a3f066eeeea69116",\n    "data": {\n      "name": "Sergio",\n      "age": 28,\n      "jobDetails": {\n        "company": "YAWE"\n      }\n    },\n    "createdAt": "2021-02-07T22:02:50.000Z",\n    "updatedAt": "2021-02-07T22:02:50.000Z"\n  }\n]\n')),Object(c.b)("p",null,"You can try out these expressions at ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://try.jsonata.org"}),"https://try.jsonata.org"),"."),Object(c.b)("h2",{id:"simple-queries"},"Simple queries"),Object(c.b)("h4",{id:"dataname"},"data.name"),Object(c.b)("p",null,"Gets an array of names."),Object(c.b)("h4",{id:"result"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'[\n  "Eduardo",\n  "Miguel",\n  "Marco",\n  "Sergio"\n]\n')),Object(c.b)("hr",null),Object(c.b)("h4",{id:"1"},"$","[1]"),Object(c.b)("p",null,"Gets the second element."),Object(c.b)("h4",{id:"result-1"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "uniqueId": "66a1212c55ce47f9bc055e6c331b7af3",\n  "data": {\n    "name": "Miguel",\n    "age": 17,\n    "phone": 999888777\n  },\n  "createdAt": "2021-02-03T21:56:54.000Z",\n  "updatedAt": "2021-02-03T21:56:54.000Z"\n}\n')),Object(c.b)("hr",null),Object(c.b)("h4",{id:"0dataname"},"$","[0]","data.name"),Object(c.b)("p",null,"Gets the name of the first element."),Object(c.b)("h4",{id:"result-2"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'"Eduardo"\n')),Object(c.b)("h2",{id:"filtering"},"Filtering"),Object(c.b)("h4",{id:"datanameeduardo"},"$",'[data.name="Eduardo"]'),Object(c.b)("p",null,"Filters records in the array containing the path ",Object(c.b)("em",{parentName:"p"},"data.name")," and matching ",Object(c.b)("em",{parentName:"p"},"Eduardo"),"."),Object(c.b)("h4",{id:"result-3"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "uniqueId": "9157c740159e4ff18b4a42d4a0c39622",\n  "data": {\n    "name": "Eduardo",\n    "phone": 999888727,\n    "age": 30\n  },\n  "createdAt": "2021-02-03T21:54:37.000Z",\n  "updatedAt": "2021-02-03T21:54:37.000Z"\n}\n')),Object(c.b)("hr",null),Object(c.b)("h4",{id:"datajobdetails"},"$","[data.jobDetails]"),Object(c.b)("p",null,"Filters records in the array containing the path ",Object(c.b)("em",{parentName:"p"},"data.jobDetails"),"."),Object(c.b)("h4",{id:"result-4"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "uniqueId": "0f6586aa7ccf4901a3f066eeeea69116",\n  "data": {\n    "name": "Sergio",\n    "age": 28,\n    "jobDetails": {\n      "company": "YAWE"\n    }\n  },\n  "createdAt": "2021-02-07T22:02:50.000Z",\n  "updatedAt": "2021-02-07T22:02:50.000Z"\n}\n')),Object(c.b)("hr",null),Object(c.b)("h4",{id:"dataage--16-and-dataage--20"},"$","[data.age > 16 and data.age < 20]"),Object(c.b)("p",null,"Filters records in the array with ",Object(c.b)("em",{parentName:"p"},"data.age")," between 16 and 20."),Object(c.b)("h4",{id:"result-5"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'[\n  {\n    "uniqueId": "66a1212c55ce47f9bc055e6c331b7af3",\n    "data": {\n      "name": "Miguel",\n      "age": 17,\n      "phone": 999888777\n    },\n    "createdAt": "2021-02-03T21:56:54.000Z",\n    "updatedAt": "2021-02-03T21:56:54.000Z"\n  },\n  {\n    "uniqueId": "86011b52ebc640aeba53a6e09a9d9773",\n    "data": {\n      "name": "Marco",\n      "age": 18\n    },\n    "createdAt": "2021-02-04T21:57:59.000Z",\n    "updatedAt": "2021-02-04T21:57:59.000Z"\n  }\n]\n')),Object(c.b)("h2",{id:"pagination"},"Pagination"),Object(c.b)("h4",{id:"01"},"$[","[0..1]","]"),Object(c.b)("p",null,"Gets the first 2 elements."),Object(c.b)("h4",{id:"result-6"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'[\n  {\n    "uniqueId": "9157c740159e4ff18b4a42d4a0c39622",\n    "data": {\n      "name": "Eduardo",\n      "phone": 999888727,\n      "age": 30\n    },\n    "createdAt": "2021-02-03T21:54:37.000Z",\n    "updatedAt": "2021-02-03T21:54:37.000Z"\n  },\n  {\n    "uniqueId": "66a1212c55ce47f9bc055e6c331b7af3",\n    "data": {\n      "name": "Miguel",\n      "age": 17,\n      "phone": 999888777\n    },\n    "createdAt": "2021-02-03T21:56:54.000Z",\n    "updatedAt": "2021-02-03T21:56:54.000Z"\n  }\n]\n')),Object(c.b)("hr",null),Object(c.b)("h4",{id:"24"},"$[","[2..4]","]"),Object(c.b)("p",null,"Gets the second 2 elements."),Object(c.b)("h4",{id:"result-7"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'[\n  {\n    "uniqueId": "86011b52ebc640aeba53a6e09a9d9773",\n    "data": {\n      "name": "Marco",\n      "age": 18\n    },\n    "createdAt": "2021-02-04T21:57:59.000Z",\n    "updatedAt": "2021-02-04T21:57:59.000Z"\n  },\n  {\n    "uniqueId": "0f6586aa7ccf4901a3f066eeeea69116",\n    "data": {\n      "name": "Sergio",\n      "age": 28,\n      "jobDetails": {\n        "company": "YAWE"\n      }\n    },\n    "createdAt": "2021-02-07T22:02:50.000Z",\n    "updatedAt": "2021-02-07T22:02:50.000Z"\n  }\n]\n')),Object(c.b)("h2",{id:"sorting"},"Sorting"),Object(c.b)("h4",{id:"--sortfunctionab-adataage--bdataage-"},"$[] ~> $sort(function($a,$b){ $a.data.age > $b.data.age })"),Object(c.b)("p",null,"Sorts the results by ascending age. In this expression we use the ",Object(c.b)("strong",{parentName:"p"},"$sort")," function to sort the results."),Object(c.b)("h4",{id:"result-8"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'[\n  {\n    "uniqueId": "66a1212c55ce47f9bc055e6c331b7af3",\n    "data": {\n      "name": "Miguel",\n      "age": 17,\n      "phone": 999888777\n    },\n    "createdAt": "2021-02-03T21:56:54.000Z",\n    "updatedAt": "2021-02-03T21:56:54.000Z"\n  },\n  {\n    "uniqueId": "86011b52ebc640aeba53a6e09a9d9773",\n    "data": {\n      "name": "Marco",\n      "age": 18\n    },\n    "createdAt": "2021-02-04T21:57:59.000Z",\n    "updatedAt": "2021-02-04T21:57:59.000Z"\n  },\n  {\n    "uniqueId": "0f6586aa7ccf4901a3f066eeeea69116",\n    "data": {\n      "name": "Sergio",\n      "age": 28,\n      "jobDetails": {\n        "company": "YAWE"\n      }\n    },\n    "createdAt": "2021-02-07T22:02:50.000Z",\n    "updatedAt": "2021-02-07T22:02:50.000Z"\n  },\n  {\n    "uniqueId": "9157c740159e4ff18b4a42d4a0c39622",\n    "data": {\n      "name": "Eduardo",\n      "phone": 999888727,\n      "age": 30\n    },\n    "createdAt": "2021-02-03T21:54:37.000Z",\n    "updatedAt": "2021-02-03T21:54:37.000Z"\n  }\n]\n')),Object(c.b)("h2",{id:"working-with-dates"},"Working with dates"),Object(c.b)("h4",{id:"combining-filter-and-tomillis"},"Combining $filter and $toMillis"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-text"}),'$[] ~> $filter(function($value){\n    $toMillis($value.createdAt)>$toMillis("2021-02-07T22:00:00.000Z")\n})\n')),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"$toMillis")," converts a ",Object(c.b)("em",{parentName:"p"},"ISO 8601")," date to milliseconds. In this example we filter all the elements created after ",Object(c.b)("em",{parentName:"p"},"2021-02-07 22:00:00"),"."),Object(c.b)("h4",{id:"result-9"},"Result"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "uniqueId": "0f6586aa7ccf4901a3f066eeeea69116",\n  "data": {\n    "name": "Sergio",\n    "age": 28,\n    "jobDetails": {\n      "company": "YAWE"\n    }\n  },\n  "createdAt": "2021-02-07T22:02:50.000Z",\n  "updatedAt": "2021-02-07T22:02:50.000Z"\n}\n')))}d.isMDXComponent=!0}}]);